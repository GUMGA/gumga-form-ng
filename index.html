<!DOCTYPE html>
<html ng-app="yourApp">
  <head>
    <meta charset="utf-8">
    <title>Gumga Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
    crossorigin="anonymous">

  </head>
  <body ng-controller="filterCtrl">

    <br><br><br>
  <div class="container">

    <form name="myForm" gumga-form>

      <campos></campos>


      <gumga-errors placement="right"
                    errors="teste"
                    icon="glyphicon glyphicon-info-sign"
                    label="Campos inválidos"
                    title="Campos inválidos">
      </gumga-errors>

      <br>
      <br>
      <br>

      <!-- {{myForm.$error}} -->
    </form>


  </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.5.0/ui-bootstrap-tpls.min.js"></script>
    <script src="node_modules/gumga-many-to-one-ng/dist/gumga-many-to-one.min.js"></script>
    <script src="node_modules/gumga-rest-ng/dist/gumga-rest.min.js"></script>
    <script src="node_modules/gumga-controller-ng/dist/gumga-controller.min.js"></script>
    <script src="dist/gumga-form.js"></script>

    <script>
    angular.module('yourApp', ['gumga.form','gumga.manytoone','gumga.controller','gumga.rest', 'ui.bootstrap'])
      .config(function ($httpProvider) {
        $httpProvider.defaults.headers.common['gumgaToken'] = 'homologacaokids'
      })
      .directive('campos', function(){
        return {
          restrict: 'E',
          link: function(){},
          templateUrl: 'form.html'
        }
      })
      .controller('filterCtrl', ['gumgaController', 'GumgaRest','$scope', '$gumgaModel', '$timeout',
        function (gumgaController, GumgaRest, $scope, $gumgaModel, $timeout) {
          var PessoaService = new GumgaRest('http://192.168.25.250/gileadeweb-api/api/pessoacadastro');
          gumgaController.createRestMethods($scope, PessoaService, 'pessoas');

          $scope.idade = 0

          $scope.selecionados = [
          ]


          // $gumgaModel
          //   .$watch($scope, 'funcionarios')


          $scope.funcionarios = {
            nome: undefined,
            idade: 2,
            enderecos: [
              {
                numero: null
              }
            ]
          }


          //IGUAL
          //DIFERENTE
          //CONTEM
          //MINIMO
          //MAXIMO


          $gumgaModel
              .$watch($scope, 'funcionario.enderecos')
              .condition('numero == null', 'Tem que colocar numero porra');


          $scope.configManyToOne = {
            ngModel : 'selecionados',
            options : {
              type: 'array',
              empty: {
                value: false,
                message: 'Está vazio'
              },
              fields: [
                // {
                //   name: 'nome',
                //   regex: {
                //     value: 'WILLIAN',
                //     message: 'Regex teste'
                //   }
                // }
              ]
            }
          }

          $scope.validateIdade = function(func){
            return {
              error: func.idade < 20,
              message: 'A idade é menor que 20'
            }
          }


          $scope.getSearch = function(param){
              return $q(function(resolve){
                  var arr = $scope.produtos.filter(function(produto){
                    return produto.nome.indexOf(param) != -1;
                  })
                  resolve(arr);
              })
          }

        }
      ]);
  </script>

  </body>
</html>
